--vw_DocenteConvocatoriaExpediente

--vw_ComentariosReclamo

--vw_TipoActividad

--vw_JefeDepartamento

--vw_Documento


CREATE OR ALTER VIEW vw_DocenteConvocatoriaExpediente
AS
SELECT 
    D.ID_DOCENTE,
    D.NOMBRE AS NOMBRE_DOCENTE,
    D.CORREO,
    D.VIGENCIA,
    D.TELEFONO,
    C.ID_CONVOCATORIA,
    C.NOMBRE AS NOMBRE_CONVOCATORIA,
    C.FECHA_INICIO,
    C.FECHA_FIN,
    E.ID_EXPEDIENTE
FROM EXPEDIENTE E
INNER JOIN DOCENTE D ON E.ID_DOCENTE = D.ID_DOCENTE
INNER JOIN CONVOCATORIA C ON E.ID_CONVOC = C.ID_CONVOCATORIA;
GO

CREATE VIEW vw_ComentariosReclamo
AS
SELECT 
    C.ID_COMENTARIO,
    C.DESCRIPCION AS COMENTARIO,
    R.ID_RECLAMO,
    R.ID_DOCUMENTO,
    R.FECHA AS FECHA_RECLAMO
FROM COMENTARIOS C
INNER JOIN RECLAMO R ON C.ID_RECLAMO = R.ID_RECLAMO;
GO

CREATE VIEW vw_TipoActividad
AS
SELECT 
    A.ID_ACTIVIDAD,
    A.NOMBRE AS NOMBRE_ACTIVIDAD,
    A.DESCRIPCION,
    T.ID_TIPO_ACTIVIDAD,
    T.NOMBRE AS NOMBRE_TIPO_ACTIVIDAD
FROM ACTIVIDAD A
INNER JOIN TIPO_ACTIVIDAD T 
    ON A.ID_TIPO_ACTIVIDAD = T.ID_TIPO_ACTIVIDAD;
GO

CREATE VIEW vw_JefeDepartamento
AS
SELECT 
    D.ID_DEPARTAMENTO,
    D.NOMBRE AS NOMBRE_DEPARTAMENTO,
    J.JEFE_ID,
    J.NOMBRE AS NOMBRE_JEFE,
    J.CORREO AS CORREO_JEFE,
    J.VIGENTE AS JEFE_VIGENTE
FROM DEPARTAMENTO D
INNER JOIN JEFE J 
    ON D.JEFE_ID = J.JEFE_ID;
GO

CREATE OR ALTER VIEW vw_Documento
AS
SELECT 
    DCE.ID_DOCENTE,
    DCE.NOMBRE_DOCENTE,
    DCE.CORREO,
    DCE.ID_EXPEDIENTE,
    DCE.ID_CONVOCATORIA,
    DCE.NOMBRE_CONVOCATORIA,
    DCE.FECHA_INICIO,
    DCE.FECHA_FIN,
    DCE.TELEFONO,

    DOC.FOLIO AS FOLIO_DOCUMENTO,
    TD.NOMBRE_DOCUMENTO,
    DOC.APROBACION,
    DOC.FECHA AS FECHA_DOCUMENTO,

    ATA.ID_ACTIVIDAD,
    ATA.NOMBRE_ACTIVIDAD,
    ATA.DESCRIPCION AS DESCRIPCION_ACTIVIDAD,
    ATA.NOMBRE_TIPO_ACTIVIDAD,

    JD.ID_DEPARTAMENTO,
    JD.NOMBRE_DEPARTAMENTO,
    JD.NOMBRE_JEFE,
    JD.CORREO_JEFE,

    CR.ID_RECLAMO,
    CR.FECHA_RECLAMO,
    CR.ID_COMENTARIO,
    CR.COMENTARIO

FROM DOCUMENTO DOC
INNER JOIN TIPO_DOCUMENTO TD 
    ON DOC.ID_TIPO_DOCUMENTO = TD.ID_TIPO_DOCUMENTO

INNER JOIN vw_DocenteConvocatoriaExpediente DCE 
    ON DOC.ID_EXPED = DCE.ID_EXPEDIENTE

INNER JOIN vw_TipoActividad ATA 
    ON DOC.ID_ACTIVIDAD = ATA.ID_ACTIVIDAD

INNER JOIN vw_JefeDepartamento JD 
    ON DOC.ID_DEPARTAMENTO = JD.ID_DEPARTAMENTO

LEFT JOIN vw_ComentariosReclamo CR 
    ON DOC.FOLIO = CR.ID_DOCUMENTO;
GO

select * from vw_Documento
SELECT * FROM DOCENTE where ID_DOCENTE = 1;
SELECT 
    D.FOLIO AS FolioDocumento,
    D.ID_TIPO_DOCUMENTO,
    D.ID_DEPARTAMENTO,
    D.ID_ACTIVIDAD,
    D.APROBACION,
    D.FECHA AS FechaDocumento,
    E.ID_EXPEDIENTE,
    E.ID_DOCENTE,
    E.ID_CONVOC AS IdConvocatoria
FROM DOCUMENTO D
INNER JOIN DOCUMENTO_EXPEDIENTE DE ON D.FOLIO = DE.ID_DOCUMENTO
INNER JOIN EXPEDIENTE E ON DE.ID_EXPEDIENTE = E.ID_EXPEDIENTE
where E.ID_DOCENTE = 1;


INSERT INTO JEFE (JEFE_ID, NOMBRE, VIGENTE, CONTRA, CORREO)
VALUES 
(1000, 'Carlos Gómez', 1, 'abcd', 'carlos@eddo.mx'),
(12, 'María Torres', 1, 'qwerty', 'maria@eddo.mx');

INSERT INTO DEPARTAMENTO (ID_DEPARTAMENTO, JEFE_ID, NOMBRE)
VALUES 
(15, 1000, 'Ingeniería en Sistemas'),
(12, 12, 'Gestión Administrativa');

INSERT INTO TIPO_DOCUMENTO (ID_TIPO_DOCUMENTO, NOMBRE_DOCUMENTO)
VALUES 
(11, 'Informe Semestral'),
(12, 'Carta de Liberación'),
(13, 'Reporte de Actividades'),
(14, 'Evaluación Final');

INSERT INTO TIPO_ACTIVIDAD (ID_TIPO_ACTIVIDAD, NOMBRE)
VALUES 
(11, 'Docencia'),
(12, 'Investigación'),
(13, 'Gestión');

INSERT INTO ACTIVIDAD (ID_ACTIVIDAD, NOMBRE, DESCRIPCION, ID_TIPO_ACTIVIDAD)
VALUES 
(11, 'Impartición de clases', 'Docencia directa en aula', 11),
(12, 'Desarrollo de proyecto IA', 'Investigación aplicada en IA', 12),
(13, 'Organización de congreso', 'Gestión de evento académico', 13);

INSERT INTO DOCUMENTO (FOLIO, ID_TIPO_DOCUMENTO, ID_EXPED, ID_DEPARTAMENTO, ID_ACTIVIDAD, APROBACION, FECHA)
VALUES 
(16, 11, 1, 15, 11, 1, '2025-02-10'),
(12, 12, 1, 11, 12, 0, '2025-03-05'),
(13, 13, 1, 11, 13, 1, '2025-04-15'),
(14, 14, 1, 12, 12, 0, '2025-05-20'),
(15, 11, 1, 12, 11, 1, '2025-06-10');

INSERT INTO RECLAMO (ID_RECLAMO, ID_DOCUMENTO, FECHA)
VALUES 
(16, 16, '2025-03-10'),
(12, 14, '2025-05-25');

select * from RECLAMO;
select * from DOCUMENTO;
INSERT INTO COMENTARIOS (ID_COMENTARIO, ID_RECLAMO, DESCRIPCION)
VALUES
(11, 11, 'El documento tiene errores en la portada.'),
(12, 12, 'Falta la firma del jefe de departamento.');
